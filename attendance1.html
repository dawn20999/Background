<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <!--[if lt IE 9]>
    <script type="text/javascript" src="js/html5.js"></script>
    <script type="text/javascript" src="js/respond.min.js"></script>
    <script type="text/javascript" src="js/pie.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="content/H-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="content/H-ui.admin.css" />
    <link rel="stylesheet" type="text/css" href="content/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="js/icheck/icheck.css" />
    <link rel="stylesheet" type="text/css" href="content/skin.css" id="skin" />
    <link rel="stylesheet" href="js/zTree/v3/css/zTreeStyle/zTreeStyle.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="content/style.css" />
    <!--[if IE 6]>
    <script type="text/javascript" src="http://lib.h-ui.net/DD_belatedPNG_0.0.8a-min.js" ></script>
    <script>DD_belatedPNG.fix('*');</script>
    <![endif]-->
    <!--/meta 作为公共模版分离出去-->

    <title>人员考勤管理</title>
</head>
<body>
<div class="attendance">
    <nav class="breadcrumb">
        人员考勤
        <span class="c-gray en">&gt;</span>
        人员考勤管理
    </nav>
    <div class="page-container">
        <div class=" pd-5 bg-1 bk-gray">
            <div class="titleBtn cl">
                <div class="l">
                    <span>考勤时段</span>
                    <input type="text" class="input-text"  onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy年MM月dd日 HH:mm'})" style="width:200px"> 至 <input type="text" class="input-text"  onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy年MM月dd日 HH:mm'})" style="width:200px">
                </div>
                <div class="ml-10 l">
                    <a href="javascript:;" onclick="selection_device()" class="btn btn-danger radius">选择设备</a>
                    <a href="javascript:;" onclick="selection_person('','chosePerson.html','400','450')" class="btn btn-danger radius">选择人员</a>
                    <a href="javascript:;" onclick="access_btn()" class="btn btn-primary radius">查看考勤</a>

                </div>
                <div class="r">
                    <a href="javascript:;" onclick="export_out()" class="btn btn-danger radius">导出记录</a>
                </div>
            </div>
        </div>
        <div class="page-pd">
            <table class="table table-border table-bordered table-hover table-bg table-sort">
                <thead>
                    <tr class="text-c">
                        <th width="250">开门时间</th>
                        <th width="250">组织</th>
                        <th width="250" >人员</th>
                        <th width="250" >手机号码</th>
                        <th width="250">设备组</th>
                        <th width="250">设备</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="text-c">
                        <td>
                            <p class="attendance-time">2016-08-05 20:00</p>
                        </td>
                        <td>
                            <p class="attendance-door">A空间会议室1</p>
                        </td>
                        <td>
                            <p class="attendance-name">孙先生</p>
                        </td>
                        <td>
                            <p class="attendance-tell">13800000000</p>
                        </td>
                        <td>
                            <p class="attendance-send">卡多宝公司</p>
                        </td>
                        <td>
                            <p class="attendance-sender">设备1</p>
                        </td>
                    </tr>
                    <tr class="text-c">
                        <td>
                            <p class="attendance-time">2016-08-05 20:00</p>
                        </td>
                        <td>
                            <p class="attendance-door">A空间会议室1</p>
                        </td>
                        <td>
                            <p class="attendance-name">孙先生</p>
                        </td>
                        <td>
                            <p class="attendance-tell">13800000000</p>
                        </td>
                        <td>
                            <p class="attendance-send">卡多宝公司</p>
                        </td>
                        <td>
                            <p class="attendance-sender">设备1</p>
                        </td>
                    </tr>
                    <tr class="text-c">
                        <td>
                            <p class="attendance-time">2016-08-05 20:00</p>
                        </td>
                        <td>
                            <p class="attendance-door">A空间会议室1</p>
                        </td>
                        <td>
                            <p class="attendance-name">孙先生</p>
                        </td>
                        <td>
                            <p class="attendance-tell">13800000000</p>
                        </td>
                        <td>
                            <p class="attendance-send">卡多宝公司</p>
                        </td>
                        <td>
                            <p class="attendance-sender">设备1</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/layer/2.1/layer.js"></script>
<script type="text/javascript" src="js/icheck/jquery.icheck.min.js"></script>
<script type="text/javascript" src="js/zTree/v3/js/jquery.ztree.all-3.5.min.js"></script>
<script src="js/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="js/H-ui.js"></script>
<script type="text/javascript" src="js/H-ui.admin.js"></script>
<!--/_footer /作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript">
//    选择设备
    function selection_device(){
        layer.open({
            type:1,
            title:false,
            closeBtn:0,
            area:['400px','450px'],
            content:'<div class="choseDevice"><div class="page-container"><div class="wrap"><div class="cl pd-5 bg-1 bk-gray"><span class="l">选择门禁</span><div class="dataTables_wrapper no-footer r"><div class="dataTables_filter"><label ><input type="search" class="input-text" id="right_search" ><a href="javascript:;" onclick="search_ztree("treeDemo1", "right_search")"   class="btn btn-primary radius">搜索</a></label></div></div></div><div class="access-tree"><ul id="treeDemo1" class="ztree"></ul></div></div><div class="choseBtn mt-20"><input class="btn btn-primary radius" id="yesBtn" type="button" value="&nbsp;&nbsp;确认&nbsp;&nbsp;"><input class="btn btn-danger radius ml-5" id="noBtn" type="button" value="&nbsp;&nbsp;取消&nbsp;&nbsp;"></div></div></div>',

        });

        var setting = {
            check: {
                enable: false
            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            view: {
                fontCss: getFontCss
            }
        };
        var zNodes =[
            { id:1, pId:0, name:"空间园区", open:true},
            { id:11, pId:1, name:"A空间", open:true},
            { id:111, pId:11, name:"A空间公用门"},
            { id:1111, pId:111, name:"A空间正门"},
            { id:1112, pId:111, name:"A空间后门"},
            { id:112, pId:11, name:"甲公司门禁"},
            { id:1121, pId:112, name:"甲公司正门"},
            { id:11211, pId:1121, name:"甲公司会议室"},
            { id:12, pId:1, name:"B空间"},
            { id:121, pId:12, name:"B空间大门"},
            { id:13, pId:1, name:"C空间"},
            { id:131, pId:13, name:"C空间公用门"},
            { id:1311, pId:131, name:"C空间公正门"},
            { id:1312, pId:131, name:"C空间公侧门"},
            { id:1313, pId:131, name:"C空间公正门"}
        ];
        $(document).ready(function(){
            $.fn.zTree.init($("#treeDemo1"), setting, zNodes);
//    取消按钮
            $("#noBtn").on('click',function(){
//                alert(1);
//                layer_close();
                $(".layui-anim").hide();
                $(".layui-layer-shade").hide();
            });
        });
//搜索树节点函数
        function showIconForTree(treeId,treeNode){
            return !treeNode.isParent;
        }
        function getFontCss(treeId, treeNode) {
            return (!!treeNode.highlight) ? {color:"#A60000", "font-weight":"bold"} : {color:"#333", "font-weight":"normal"};
        }
        function expand_ztree(treeId){
            var treeObj = $.fn.zTree.getZTreeObj(treeId);
            treeObj.expandAll(true);
        }
        function search_ztree(treeId, searchConditionId){
            searchByFlag_ztree(treeId, searchConditionId, "");
        }
        function searchByFlag_ztree(treeId, searchConditionId, flag){
            //<1>.搜索条件
            var searchCondition = $('#' + searchConditionId).val();
            //<2>.得到模糊匹配搜索条件的节点数组集合
            var highlightNodes = new Array();
            if (searchCondition != "") {
                var treeObj = $.fn.zTree.getZTreeObj(treeId);
                highlightNodes = treeObj.getNodesByParamFuzzy("name", searchCondition, null);
            }
            //<3>.高亮显示并展示【指定节点s】
            highlightAndExpand_ztree(treeId, highlightNodes, flag);
        }
        function highlightAndExpand_ztree(treeId, highlightNodes, flag){
            var treeObj = $.fn.zTree.getZTreeObj(treeId);
            //<1>. 先把全部节点更新为普通样式
            var treeNodes = treeObj.transformToArray(treeObj.getNodes());
            for (var i = 0; i < treeNodes.length; i++) {
                treeNodes[i].highlight = false;
                treeObj.updateNode(treeNodes[i]);
            }
            //<2>.收起树, 只展开根节点下的一级节点
//        close_ztree(treeId);
            //<3>.把指定节点的样式更新为高亮显示，并展开
            if (highlightNodes != null) {
                for (var i = 0; i < highlightNodes.length; i++) {
                    if (flag != null && flag != "") {
                        if (highlightNodes[i].flag == flag) {
                            //高亮显示节点，并展开
                            highlightNodes[i].highlight = true;
                            treeObj.updateNode(highlightNodes[i]);
                            //高亮显示节点的父节点的父节点....直到根节点，并展示
                            var parentNode = highlightNodes[i].getParentNode();
                            var parentNodes = getParentNodes_ztree(treeId, parentNode);
                            treeObj.expandNode(parentNodes, true, false, true);
                            treeObj.expandNode(parentNode, true, false, true);
                        }
                    } else {
                        //高亮显示节点，并展开
                        highlightNodes[i].highlight = true;
                        treeObj.updateNode(highlightNodes[i]);
                        //高亮显示节点的父节点的父节点....直到根节点，并展示
                        var parentNode = highlightNodes[i].getParentNode();
                        var parentNodes = getParentNodes_ztree(treeId, parentNode);
                        treeObj.expandNode(parentNodes, true, false, true);
                        treeObj.expandNode(parentNode, true, false, true);
                    }
                }
            }
        }
        function getParentNodes_ztree(treeId, node){
            if (node != null) {
                var treeObj = $.fn.zTree.getZTreeObj(treeId);
                var parentNode = node.getParentNode();
                return getParentNodes_ztree(treeId, parentNode);
            } else {
                return node;
            }
        }
        /**
         * 设置树节点字体样式
         */
        function setFontCss_ztree(treeId, treeNode) {
            if (treeNode.id == 0) {
                //根节点
                return {color:"#333", "font-weight":"bold"};
            } else if (treeNode.isParent == false){
                //叶子节点
                return (!!treeNode.highlight) ? {color:"#fff", "font-weight":"bold"} : {color:"#ccc", "font-weight":"normal"};
            } else {
                //父节点
                return (!!treeNode.highlight) ? {color:"#ff0000", "font-weight":"bold"} : {color:"#333", "font-weight":"normal"};
            }
        }

    }


//    选择人员
    function selection_person(title,url,w,h){
        layer_show(title,url,w,h)
    }
    //    查询考勤
    function access_btn(){
        layer.confirm('<div class="cancle">请选择查询人员</div>',{
            btn:['确认']
        });
    }
//    导出记录
    function export_out(){
        layer.confirm('<div class="cancle">导出成功</div>',{
            btn:['确认']
        });
    }
</script>
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>